dist: bionic
language: java
sudo: required
env:
- COMPOSE_FILE=docker-compose.devel.yml MODELS=$TRAVIS_BUILD_DIR/bigg_models_data/models
jdk:
- openjdk11
services:
- docker
notifications:
  email: false
  slack:
    secure: UVpVWlZ2MmsntVl5H9IlSOTz27eF48SJUZLHsi/VYeQOLCX/kWpwP/f0/EjrWqOhhkMjGvLMMvAfQZ4QTJtxtw52+Bb1DalMTslPkyRKq6yobRcFuZifD+mCmplhiNQUxiefCjaLcBiCzSmwBhFw+6eVmh5AX01DBTQt8XBn6SxQ8eGutpn/721ZC4d2TP483gj2yTOzdP/s0unRw47sFyAwcfmJilraUxrXVIdvM3YBzAnUa2+77EUNJ6LBeWsy2fRpgFwYbRdsbU5lZJKskasdG2+z9gOGEe/RDirpEGSBnteHiye6++CCD+CGS7szfycjCUsLkq54e2g/HgO32sbpSD74YWOWyQf2VimxRDitSkuv2dleIzGrhe636UqzjTLd/eWkJP5keao6nGKypOnUGD14wI9a8kqp0/e5q5ts+OXzvESGvAiug9WTYNqlpVdZWmYYNUzhqbqHNHpS/cR+nD6Z1ZWRy/m12m5VTR2zHmke8VQZUcKBjIS6LztYqknhWz3BYO0BOsMPo0BYSGrta7fKBAFNf/RlFk/5vAfdHLkL0ZzJgypNl1+twmNHTvM/z2xj247wI5aISB3lt++wmjCHLiAr4NzOxOxyLyT1l+ev6mDBvQtip37CgVthys08QaAnWwnZPe/xGeareoq8b4VF6iT/JlAnDcZCagM=
before_install:
- git clone https://github.com/SBRG/bigg_models_data
install:
- printf "FROM openjdk:11-slim\n\nCOPY ModelPolisher-2.1-beta.jar /\nCMD \"/bin/sh\""
  > docker/java_docker/Dockerfile
- gradle devel
- docker-compose up -d
- docker ps -a
before_script:
- echo "Waiting for databases"
- while ! pg_isready -h 0.0.0.0 -p 1310 > /dev/null; do sleep 1; done
- while ! pg_isready -h 0.0.0.0 -p 1013 > /dev/null; do sleep 1; done
- echo "Databases are up"
script:
- travis_wait docker-compose run -v $MODELS:/models polisher sh -c "java -jar /ModelPolisher-2.1-beta.jar
  --input=/models/ecoli_core_model.xml --output=/models/out/ecoli_core_model.xml --annotate-with-bigg=true
  --add-adb-annotations=true --output-combine=true && ls -lish models/out"
- travis_wait docker-compose run -v $MODELS:/models polisher sh -c "java -jar /ModelPolisher-2.1-beta.jar
  --input=/models/yeast_7.00.xml --output=/models/out/yeast_7.00.xml --annotate-with-bigg=true
  --add-adb-annotations=true --output-combine=true && ls -lish models/out"
- travis_wait docker-compose run -v $MODELS:/models polisher sh -c "java -jar /ModelPolisher-2.1-beta.jar
  --input=/models/RECON1.xml --output=/models/out/RECON1.xml --annotate-with-bigg=true
  --add-adb-annotations=true --output-combine=true && ls -lish models/out"
after_script:
- docker-compose down
git:
  depth: 1
