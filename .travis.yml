dist: bionic
language: java
sudo: required
env:
- COMPOSE_FILE=docker-compose.devel.yml MODELS=$TRAVIS_BUILD_DIR/bigg_models_data/models
jdk:
- openjdk11
services:
- docker
notifications:
  email: false
  slack:
    secure: SvCXX0eGJspiqN+X/3TV/PhOvIgtG6bP1iQi9/HlS4qdGx3z8PWGpSdVfIfqf+7x9a7kAnALNU+skvwwStBxB7ybzH52zKnF1X4Tx0WXKatrUAIa274X7ORh9/LBJRiOGitXPrHAr3n01SEoguwxTg56kUQXnH0IAjXJH/A7glVEKgSNRGrKm6UjRuLV3ktVZZx6y0ldfFRX3yd5Kajh4lAoA1DU+FdcPdtZrDCc+xvE/8iKbfvOJjb4QJQHKdiccO9x3H44A4eNYllccNlgLbCkS3mT74i7hO4KmscfwLO/X6T10mIhEY1qKUH82s3O/cfrk7dvLGMtqr9xecFl8K3UGU+Nvf/5nC6FkkE89HQHfQspSuXsGXZqC6mgiBHAB7CabA/ZHFyrCyiuQhND4wkd27HCJL3QIDMFtMuv03SZLOhhjN7K+QFQZGMwAq/gaGiLCo2Tke1Zv/SZ3Z1DMBt8SzW+wBdnRZ+HEb8RvPYPA/U7o1HJpUqU7uBYr1EDyLNz+2QGb3feOUWVftgeXHWJS3kdopIop+bUVRyD6kNiRgnJ3AIAO4IvT8oWALjo1SCcVHt3EPFXErYMQ5kRn2vWqiluyM5lBw5ID3MZRQAFVOsGwW7MgjVbQvR+g7q+J7wLQZUXXfiiW9pLYLGe5EvIPHKjggcLcsXCTssk8IY=
before_install:
- git clone https://github.com/SBRG/bigg_models_data
install:
- printf "FROM openjdk:11-slim\n\nCOPY ModelPolisher-2.1.jar /\nCMD \"/bin/sh\"" >
  docker/java_docker/Dockerfile
- gradle devel
- docker-compose up -d
- docker ps -a
before_script:
- echo "Waiting for databases"
- while ! pg_isready -h 0.0.0.0 -p 1310 > /dev/null; do sleep 1; done
- while ! pg_isready -h 0.0.0.0 -p 1013 > /dev/null; do sleep 1; done
- echo "Databases are up"
script:
- travis_wait docker-compose run -v $MODELS:/models polisher sh -c "java -jar /ModelPolisher-2.1.jar
  --input=/models/ecoli_core_model.xml --output=/models/out/ecoli_core_model.xml --annotate-with-bigg=true
  --sbml-validation=true --compression-type=GZIP && ls -lish models/out"
- travis_wait docker-compose run -v $MODELS:/models polisher sh -c "java -jar /ModelPolisher-2.1.jar
  --input=/models/yeast_7.00.xml --output=/models/out/yeast_7.00.xml --annotate-with-bigg=true
  --sbml-validation=true --compression-type=GZIP && ls -lish models/out"
- travis_wait docker-compose run -v $MODELS:/models polisher sh -c "java -jar /ModelPolisher-2.1.jar
  --input=/models/RECON1.xml --output=/models/out/RECON1.xml --annotate-with-bigg=true
  --sbml-validation=true --compression-type=GZIP && ls -lish models/out"
after_script:
- docker-compose down
git:
  depth: 1
